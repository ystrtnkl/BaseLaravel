<VirtualHost *:80>
    ServerAdmin webmaster@localhost

    # 1. CRITICAL FIX: Point DocumentRoot directly to the public directory
    # This prevents access to sensitive files like .env and composer.json
    DocumentRoot /var/www/html/proyecto/public 

    # 2. Add a Directory block for the DocumentRoot to enable mod_rewrite
    <Directory /var/www/html/proyecto/public>
        # Allow Apache to read the files and execute the rewrite rules
        Options FollowSymLinks
        AllowOverride All 
        Require all granted

        # Standard Laravel mod_rewrite block (usually defined in public/.htaccess)
        # This sends all requests not pointing to a real file/directory to index.php
        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteRule ^ index.php [L]
        </IfModule>
    </Directory>
    
    # 3. CLEANUP: Remove all the custom <Directory> blocks you had previously defined
    # The default configuration handles everything now.
    
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>